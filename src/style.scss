@import "scss/__reset";

// Transitions
// Fontweights (if using one font)

$black: black;
$white: white;
$t--1: #f4f6f6;
$t--2: #ddd;
$t--3: #aaa;
$t--4: #333333;

$c--text: $t--4;

$colorTinter: 10%;

$c--1: rgb(245, 215, 97);
$c--2: #fc763d;
$c--3: #516beb;

$c--1x: lighten($c--1, $colorTinter);
$c--2x: lighten($c--2, $colorTinter);
$c--3x: lighten($c--3, $colorTinter);

$c--success: $c--3;
$c--fail: $c--2;

$g--1: linear-gradient(to right, $c--1, $c--1x);
$g--2: linear-gradient(to right, $c--2, $c--2x);
$g--3: linear-gradient(to right, $c--3, $c--3x);
$g--bl: linear-gradient(to right, $t--4, $black);

$f--1: freight-sans-pro;

$omega: 0.8rem;
$alpha: 1rem;
$bralpha: 1.3rem;
$bravo: 1.6rem;
$chavo: 2rem;
$charlie: 2.56rem;
$delta: 4.1rem;

$fw--light: 400;
$fw--std: 500; // 500?
$fw--bold: 700; // 700?
$fw--black: 900;

$space: 1rem;
$pad: 0.75 * $space;

$border: 0.125rem;
$borderette: 0.5 * $border;

$period--fast: 0.125s;
$period--std: 0.25s;
$period--slow: 0.5s;

$h--task: 2.5 * $space;
$h--taskOption: $h--task - 0.5rem;

$p--taskOptionPad: 0.25 * $pad;
$p--taskOptionEnd: $pad;
$w--taskOptionDec: $space;
$w--statusOptions1: $w--taskOptionDec + (3 * $h--taskOption) +
   $p--taskOptionPad;
$w--metaOptions1: $w--taskOptionDec + (2 * $h--taskOption) +
   $p--taskOptionEnd + $p--taskOptionPad;

$d--skew: 2deg, 1deg;
@mixin bg--sm() {
   margin-left: -3px;
   margin-top: -3px;
   //transform: skew($d--skew);
}

@mixin avatar($name) {
   background: url("./_img/avatar--#{ $name }") contain center center
      no-repeat;
}

@mixin _avatar($name) {
   background-image: url("./_img/avatar--#{ $name }");
}

@mixin taskOption--final($dir: "left") {
   margin-#{ $dir }: $p--taskOptionEnd;

   &:before {
      content: "";
      position: absolute;
      top: 0.5 * $pad;
      bottom: 0.5 * $pad;
      #{ $dir }: -0.5 * $pad;
      border-#{ $dir }: $border $white solid;
      margin-#{ $dir }: -0.5 * $border;
   }
}

html {
   font-size: 20px;
   font-family: $f--1;
   color: $c--text;
}

ul {
   list-style: none;
}

.c-header {
   padding: 0 $pad;
   background: $g--1;

   transition: $period--fast;

   .c-compliance--incomplete & {
      background: $g--1;
   }

   .c-compliance--awaitingReview & {
      background: $g--2;
   }

   .c-compliance--complete & {
      background: $g--3;
   }
}

.c-nav {
   display: flex;
   justify-content: flex-end;
   padding: $pad 0;
   border-bottom: $border $white solid;
}

.c-user {
   height: 2 * $space;
   width: 0.875 * 2 * $space;
   position: relative;

   &:before,
   &:after {
      content: "";
      position: absolute;
      left: 0;
      top: 0;
   }

   &:before {
      content: "";
      position: absolute;
      z-index: 0;
      background-color: rgba($black, 0.75);
      top: -0.125 * $pad;
      right: 0;
      bottom: 0;
      left: -0.125 * $pad;
      @include bg--sm();
   }

   &:after {
      width: 100%;
      height: 100%;
      @include avatar("plain1.svg");
      background-size: contain;
   }

   .c-compliance--incomplete &:after {
      @include _avatar("plain1.svg");
   }

   .c-compliance--awaitingReview &:after {
      @include _avatar("plain2.svg");
   }

   .c-compliance--complete &:after {
      @include _avatar("plain3.svg");
   }
}

.c-user--manager:after {
   @include _avatar("visor1.svg");

   .c-compliance--incomplete & {
      @include _avatar("visor1.svg");
   }

   .c-compliance--awaitingReview & {
      @include _avatar("visor2.svg");
   }

   .c-compliance--complete & {
      @include _avatar("visor3.svg");
   }
}

.c-viewsWrap {
   overflow: hidden;
}

.c-views {
   position: relative;
   height: 6 * $space;
   transition: $period--slow;

   // Slide relevant child in to view
   .c-compliance--incomplete & {
      transform: translate3d(0, 0, 0);
   }

   .c-compliance--awaitingReview & {
      transform: translate3d(-100%, 0, 0);
   }

   .c-compliance--complete & {
      transform: translate3d(-200%, 0, 0);
   }
}

.c-view {
   display: flex;
   align-items: center;
   justify-content: space-around;
   position: absolute;
   top: 0;
   bottom: 0;
   left: 0;
   right: 0;
   padding: $space;
   color: $white;
   font-size: $chavo;
   font-weight: 900;
   text-shadow: 1px 1px 1px rgba(0, 0, 0, 0.25);
   text-align: center;

   &:nth-of-type(2) {
      transform: translate(100%, 0);
   }

   &:nth-of-type(3) {
      transform: translate(200%, 0);
   }
}

.c-categories {
   padding: $space 0;
}

.c-category {
   padding: 0 $pad;

   & + & {
      margin-top: 2 * $space;
   }
}

.c-category__title {
   position: relative;
   display: inline-block;
   text-transform: uppercase;
   color: $t--3;
   font-weight: 900;
   transition: $period--fast;

   &:before {
      content: "";
      position: absolute;
      height: 0.75 * $pad;
      left: 0;
      right: 0;
      top: 100%;
      background: $g--1;
      transition: $period--fast;
      filter: grayscale(100%);
   }

   .js-isVisible & {
      color: $c--text;

      &:before {
         filter: grayscale(0);
      }
   }
}

.c-tasks {
   margin-right: $pad;
   overflow: hidden;
   &:not(:first-child) {
      margin-top: 1.5 * $space;
   }
}

.c-task {
   position: relative;

   & + & {
      margin-top: $pad;
   }
}

.c-task__header {
   background: $t--1;
   transition: $period--std;

   > * {
      height: $h--task;
   }

   .c-compliance--incomplete .js-showStatusOptions & {
      transform: translate3d(#{$w--statusOptions1}, 0, 0);
   }

   .c-compliance--incomplete .js-showMetaOptions & {
      transform: translate3d(-#{$w--metaOptions1}, 0, 0);
   }
}

.c-task__face {
   display: flex;
}

.c-task__currentStatusWrap {
   width: $h--task;
   position: relative;
   transition: width $period--std;
   overflow: hidden;

   .js-showStatusOptions & {
      width: 0;
      opacity: 0;
   }
}

.c-task__currentStatus {
   position: absolute;
   left: 50%;
   top: 50%;
   transform: translate(-50%, -50%);
   height: 0.75 * $space;
   width: 0.75 * $space;

   .c-icon--incomplete:before {
      background-color: $t--2;
   }
}

.c-task__currentStatus--incomplete {
}

.c-task__title {
   font-size: $bralpha;
   font-weight: $fw--light;
   line-height: $h--task;
   flex-grow: 100;
   margin-left: $pad;
   position: relative;

   &:before {
      content: "";
      position: absolute;
      top: 0.75 * $pad;
      bottom: 0.75 * $pad;
      left: -$pad;
      margin-left: -0.5 * $border;
      border-left: $border $black solid;
      opacity: 1;
      transition: $period--fast;
   }

   .js-showStatusOptions & {
      &:before {
         opacity: 0;
      }
   }
}

.c-task__statusOptions,
.c-task__metaOptions {
   position: absolute;
   top: 0;
   display: flex;
   align-items: center;
   transition: $period--std;

   &:after {
      content: "";
      position: absolute;
      top: 0;
      bottom: 0;
      border-width: 0.5 * $h--task 0.5 * $w--taskOptionDec;
      border-style: solid;
      border-color: $t--1;
   }
}

.c-task__statusOption,
.c-task__metaOption {
   position: relative;
   width: $h--taskOption;
   height: $h--taskOption;

   &.js-isActive {
      background: rgba($white, 0.25);
   }
}

.c-task__statusOptions {
   right: 100%;
   margin-right: $w--taskOptionDec;
   background: $g--1;
   padding-left: $p--taskOptionPad;

   &:after {
      border-bottom-color: $c--1x;
      border-left-color: $c--1x;
      left: 100%;
   }

   .c-compliance--incomplete & {
      background: $g--1;

      &:after {
         border-bottom-color: $c--1x;
         border-left-color: $c--1x;
      }
   }

   .c-compliance--awaitingReview & {
      background: $g--2;

      &:after {
         border-bottom-color: $c--2x;
         border-left-color: $c--2x;
      }
   }

   .c-compliance--complete & {
      background: $g--3;

      &:after {
         border-bottom-color: $c--3x;
         border-left-color: $c--3x;
      }
   }
}

.c-task__statusOption--undo {
   @include taskOption--final(left);
}

.c-task__metaOptions {
   left: 100%;
   margin-left: $w--taskOptionDec;
   background: $g--bl;
   padding-right: $p--taskOptionPad;

   &:after {
      border-top-color: $t--4;
      border-right-color: $t--4;
      right: 100%;
   }
}

.c-task__metaOption {
   .c-compliance--incomplete &.js-isActive {
      .c-icon:before {
         background-color: $c--1;
      }
   }
}

.c-task__metaOption--info {
   @include taskOption--final(left);
}

$icons: (
   "incomplete",
   "failed",
   "fixed",
   "complete",
   "undo",
   "info",
   "comments"
);

.c-icon {
   &:before,
   &:after {
      content: "";
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      width: 0.5 * $h--task;
      height: 0.5 * $h--task;
   }

   &:before {
      @include bg--sm();
      border-radius: 100%;
      transform: translate(-50%, -50%) skey($d--skew);
   }

   &:after {
      background-repeat: no-repeat;
      background-position: center center;
      background-size: contain;
   }
}

@each $icon in $icons {
   .c-icon--#{ $icon } {
      &:after {
         background-image: url(./_img/i-#{ $icon }.svg);
      }

      .js-isActive & {
         &:after {
            background-image: url(./_img/i-#{ $icon }--active.svg);
         }
      }
   }
}

.js-isActive .c-icon--incomplete:before {
   background-color: $t--1;
}
.js-isActive .c-icon--complete:before {
   background-color: $c--success;
}
.js-isActive .c-icon--failed:before {
   background-color: $c--fail;
}
.js-isActive .c-icon--fixed:before {
   background-color: $c--fail;
}

// .c-view {
//    & + & {
//       margin-top: 2 * $space;
//    }
// }

// .c-view__title {
//    text-transform: uppercase;
//    font-family: $f2;
//    font-size: $bralpha;
//    position: relative;
//    font-weight: 900;
//    margin-bottom: $pad;
// }

// .c-tasks {
//    position: relative;
//    margin-top: $space;
//    &:after {
//       content: "";
//       position: absolute;
//       right: $space + $pad;
//       top: 0;
//       bottom: 0;
//       border-right: 2px $black dotted;
//    }

//    .c-view__title + & {
//       margin-top: $pad;
//    }
// }

// .c-task {
//    position: relative;

//    & + & {
//       margin-top: $pad;
//       padding-top: $pad;

//       &:before {
//          content: "";
//          position: absolute;
//          border-top: 2px $black dotted;
//          left: 0;
//          right: 0;
//          top: -1px;
//       }
//    }

//    .c-view--awaitingReview &,
//    .c-view--complete & {
//       display: flex;
//       flex-wrap: wrap;
//       align-items: center;
//       position: relative;
//       padding-right: (2 * $space) + $pad;
//    }
// }

// $fs_title--big: $bravo;
// $fs_title--small: $bralpha;

// .c-task__title {
//    font-family: $f2;
//    font-weight: 300;
//    line-height: 1;
//    padding-right: (2 * $space) + $pad;
//    font-size: $fs_title--small;
// }

// .c-taskMeta__toggle {
//    width: $bravo;
//    height: $bravo;
//    position: absolute;
//    top: $pad;
//    right: 0;
//    text-align: center;
//    transform-origin: center center;
//    transition: 0.15s;
//    background: url(_img/plus-duotone.svg) center center no-repeat;
//    background-size: 50%;
//    margin-top: -#{0.5 * ($fs_title--big - $fs_title--small)};

//    :first-child > & {
//       top: 0;
//    }

//    &.isVisible {
//       transform: rotate(45deg);
//    }
// }

// .c-taskMetaWrap {
//    max-height: 0;
//    width: 100%;
//    overflow: hidden;
//    transition: 0.3s cubic-bezier(0.01, 0, 0.06, 1);

//    &.isVisible {
//       max-height: 1000px;
//       transition: 0.75s cubic-bezier(0.81, 0.01, 0.22, 1);
//    }
// }

// .c-taskMeta {
//    transform: translate3d(0, -100%, 0);
//    transition: 0.25s ease-in;

//    .isVisible & {
//       transform: translate3d(0, 0, 0);
//       transition: 0.2s ease 0.1s;
//    }
// }

// .c-toolbar {
//    display: flex;
//    align-items: center;
//    margin-top: 0.75 * $pad;
// }

// $h--toolbar__item: 2 * $omega;
// $ratio: 0.66;
// $w--icon: 0.9 * $h--toolbar__item * $ratio;

// .c-toolbar__item {
//    font-size: $omega;
//    text-transform: uppercase;
//    line-height: $h--toolbar__item;
//    font-family: $f2;

//    & + & {
//       margin-left: 0.5 * $pad;
//    }

//    &:before {
//       font-weight: bold;
//    }
// }

// .c-toolbar__item--link {
//    position: relative;
//    text-indent: $w--icon + (0.5 * $pad);
//    background: $t--1;
//    padding: 0 $pad;
//    cursor: pointer;

//    &:before {
//       content: "";
//       position: absolute;
//       display: inline-block;
//       margin-right: 0.5 * $pad;
//       width: $w--icon;
//       background-position: center center;
//       background-size: contain;
//       background-repeat: no-repeat;
//       top: 0;
//       bottom: 0;
//       left: $pad;
//    }
// }

// .c-toolbar__item--worker {
//    &:before {
//       content: "Doer: ";
//    }
// }

// .c-toolbar__item--reviewer {
//    &:before {
//       content: "Reviewer: ";
//    }
// }

// .c-toolbar__item--reportProblem {
//    &:before {
//       background-image: url(_img/skull-crossbones-duotone.svg);
//    }
// }

// .c-toolbar__item--undo {
//    &:before {
//       background-image: url(_img/undo-duotone.svg);
//    }
// }

// .c-categories--incomplete {
//    .c-task__title {
//       cursor: pointer;
//    }

//    .c-taskMeta__toggle {
//       margin-top: 0;
//    }

//    .c-task--awaitingReview .c-task__title,
//    .c-task--blocked .c-task__title {
//       text-decoration: line-through;
//    }

//    .c-task--awaitingReview .c-task__title {
//       color: $t--2;
//    }

//    .c-task--blocked .c-task__title {
//       color: $c--fail;
//    }
// }

// .c-categories--awaitingReview {
//    .c-task__title {
//       padding-right: 0;
//       width: 50%;
//       position: relative;
//       white-space: nowrap;
//       overflow: hidden;
//       text-overflow: ellipsis;
//    }

//    .c-task--blocked .c-task__title {
//       &:before {
//          content: "(!) ";
//          color: $c--fail;
//          font-weight: bold;
//       }
//    }
// }

// .c-categories--complete {
//    .c-task__title {
//       text-decoration: line-through;
//    }

//    .c-task--complete .c-task__title {
//       //color: $c--success;
//    }

//    .c-task--failed .c-task__title {
//       color: $c--fail;
//    }
// }

// .c-task__actions {
//    width: 50%;
//    display: flex;
//    justify-content: flex-end;
// }

// .c-task__action {
//    position: relative;
//    text-align: center;
//    width: $bralpha;
//    height: $bralpha;

//    &:before {
//       content: "" !important;
//    }

//    &:after {
//       content: "";
//       position: absolute;
//       top: 0;
//       right: 0;
//       bottom: 0;
//       left: 0;
//       transform: translate3d(-2 * $borderette, -2 * $borderette, 0);
//       border: $borderette black solid;
//    }

//    & + & {
//       margin-left: $pad;
//    }

//    .c-task--blocked & {
//       width: (1.5 * $bralpha) + (0.5 * $pad);
//    }
// }

// .c-task__action--reviewed {
//    background-color: lighten($c--success, 0%);

//    &:before {
//       content: "\002713";
//       color: darken($c--success, 50%);
//       font-weight: bold;
//    }

//    &:after {
//       border-color: darken($c--success, 25%);
//    }
// }

// .c-task__action--fixed {
//    background-color: lighten($c--warning, 0%);
//    &:before {
//       content: "!";
//       color: darken($c--warning, 50%);
//    }
//    &:after {
//       border-color: darken($c--warning, 25%);
//    }
// }

// .c-task__action--failed {
//    background-color: lighten($c--fail, 0%);

//    &:before {
//       content: "\010102";
//       color: darken($c--fail, 50%);
//    }

//    &:after {
//       border-color: darken($c--fail, 25%);
//    }
// }

// .c-subtasks {
//    padding-top: 0.5 * $pad;
// }

// .c-subtask {
//    font-family: $f3;
//    padding: 0.125em 0;

//    &:before {
//       content: "+ ";
//    }
// }

// .c-commentForm {
//    position: relative;

//    * + & {
//       margin-top: $space;
//    }
// }

// .c-commentForm__title {
//    font-family: $f2;
//    font-weight: bold;
// }

// @keyframes submit {
//    0% {
//       box-shadow: $c--success 0 0 0.25 * $pad 0.25 * $pad inset;
//       border-color: $c--success;
//    }

//    100% {
//       box-shadow: transparent 0 0 0.25 * $pad 0.25 * $pad inset;
//       border-color: $black;
//    }
// }

// .c-commentForm__textarea {
//    width: 100%;
//    padding: $pad;
//    height: 1.2 * 6em;
//    box-sizing: border-box;
//    margin: 0;
//    position: relative;
//    z-index: 1;
//    font-size: $alpha;
//    font-family: $f3;
//    font-style: normal;
//    border: 1px $black solid;
//    border-radius: none;

//    &.hasSubmitted {
//       animation-name: submit;
//       animation-duration: 0.25s;
//       animation-iteration-count: 1;
//    }

//    * + & {
//       margin-top: $pad;
//    }
// }

// .c-commentForm__buttonWrap {
//    position: absolute;
//    top: 0;
//    right: 0;
// }

// .c-commentForm__button {
//    display: inline-block;
//    font-family: $f2;
//    position: relative;
//    text-transform: uppercase;
//    font-weight: normal;
//    font-size: $omega;
//    line-height: $alpha;
//    text-indent: $w--icon + (0.5 * $pad);
//    padding: 0 $pad;
//    cursor: pointer;
//    transform: translate3d(0, 2.5 * $space, 0);
//    transition: 0.15s ease-in;

//    .hasText & {
//       transform: translate3d(0, 0, 0);
//    }

//    &:before,
//    &:after {
//       content: "";
//       position: absolute;
//       z-index: -1;
//    }

//    &:before {
//       line-height: $h--toolbar__item;
//       background: $t--1;
//       left: 0;
//       right: 0;
//       top: -0.5 * $pad;
//       bottom: -0.5 * $pad;
//    }

//    &:after {
//       display: inline-block;
//       margin-right: 0.5 * $pad;
//       width: $w--icon;
//       background-image: url(./_img/check-duotone.svg);
//       background-position: center center;
//       background-size: contain;
//       background-repeat: no-repeat;
//       top: 0;
//       bottom: 0;
//       left: $pad;
//    }
// }

// $h--avatar: 2rem;

// .c-comments {
//    * + & {
//       margin-top: $space;
//    }

//    // Magic
//    &:last-child {
//       margin-bottom: $pad;
//    }
// }

// .c-comment {
//    position: relative;
//    padding-left: $h--avatar + $pad;

//    & + & {
//       margin-top: 2 * $space;
//    }

//    &:after {
//       content: "";
//       position: absolute;
//       top: $h--avatar + (0.5 * $pad);
//       bottom: 0;
//       left: 0.5 * $h--avatar;
//       border-left: 6px $t--2 solid;
//       margin-left: -3px;
//    }

//    &:nth-child(even):after {
//       border-color: $black;
//    }
// }

// .c-comment__meta {
//    display: flex;
//    justify-content: space-between;
// }

// .c-comment__avatar {
//    width: $h--avatar;
//    height: $h--avatar;
//    position: absolute;
//    left: 0;
//    top: 0;
//    background: url(./_img/user-astronaut-duotone.svg) center center
//       no-repeat;
//    background-size: contain;
// }

// .c-comment__avatar--astronaut {
//    background-image: url(./_img/user-astronaut-duotone.svg);
// }

// .c-comment__avatar--cowboy {
//    background-image: url(./_img/user-cowboy-duotone.svg);
// }

// .c-comment__avatar--crown {
//    background-image: url(./_img/user-crown-duotone.svg);
// }

// .c-comment__avatar--ninja {
//    background-image: url(./_img/user-ninja-duotone.svg);
// }

// .c-comment__avatar--robot {
//    background-image: url(./_img/user-robot-duotone.svg);
// }

// .c-comment__avatar--secret {
//    background-image: url(./_img/user-secret-duotone.svg);
// }

// .c-comment__avatar--tie {
//    background-image: url(./_img/user-tie-duotone.svg);
// }

// .c-comment__avatar--visor {
//    background-image: url(./_img/user-visor-duotone.svg);
// }

// .c-comment__author {
//    font-family: $f2;
//    font-weight: bold;
//    line-height: $h--avatar;
// }

// .c-comment__text {
//    font-family: $f3;
// }

// .c-comment__action {
//    line-height: $h--avatar;
//    font-family: $f2;
//    position: relative;
//    text-transform: uppercase;
//    font-weight: normal;
//    font-size: $omega;
//    cursor: pointer;
//    text-indent: $w--icon + (0.5 * $pad);
//    padding: 0 $pad;
//    background: $t--1;
//    display: inline-block;

//    &:before {
//       content: "";
//       position: absolute;
//       display: inline-block;
//       margin-right: 0.5 * $pad;
//       width: $w--icon;
//       background-position: center center;
//       background-size: contain;
//       background-repeat: no-repeat;
//       top: 0;
//       bottom: 0;
//       left: $pad;
//    }

//    & + & {
//       margin-left: $pad;
//    }
// }

// .c-comment__action--edit {
//    &:before {
//       background-image: url(./_img/pencil-alt-duotone.svg);
//    }

//    &:after {
//       content: "edit";
//    }
// }

// .c-comment__action--delete {
//    &:before {
//       background-image: url(./_img/trash-alt-duotone.svg);
//    }

//    &:after {
//       content: "delete";
//    }
// }
